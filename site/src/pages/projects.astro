---
// src/pages/projects.astro
import BaseLayout from '../layouts/BaseLayout.astro';
import ProjectCard from '../components/ProjectCard.astro';
import { projects } from '../data/projects';

// label/value so we can show nice text but filter on a clean slug
const categories = [
  { label: 'All', value: 'all' },
  { label: 'AI/ML', value: 'ai-ml' },
  { label: 'Automation', value: 'automation' },
  { label: 'Web Apps', value: 'web-apps' },
  { label: 'Bots', value: 'bots' },
  { label: 'Games', value: 'games' },
  { label: 'Systems/Low-Level', value: 'systems' },
];
---

<BaseLayout 
  title="Projects - Portfolio"
  description="Explore my portfolio of web development projects"
>
  <!-- Hero Section -->
  <section class="section-container bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900">
    <div class="text-center max-w-3xl mx-auto">
      <h1 class="text-4xl sm:text-5xl font-bold mb-6">
        My <span class="bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">Projects</span>
      </h1>
      <p class="text-lg text-gray-600 dark:text-gray-400">
        A collection of projects I've built to solve real-world problems and explore new technologies. 
        Each project represents a unique challenge and learning experience.
      </p>
    </div>
  </section>

  <!-- Filter Section -->
  <section class="section-container bg-white dark:bg-gray-900">
    <div class="flex flex-wrap justify-center gap-3 mb-12">
      {categories.map(c => (
        <button 
          class="filter-btn px-6 py-2 rounded-full font-medium transition-all hover:scale-105"
          data-value={c.value}
        >
          {c.label}
        </button>
      ))}
    </div>

    <!-- Projects Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="projects-grid">
      {projects.map(project => (
        <ProjectCard {...project} category={project.category} />
      ))}
    </div>

    <!-- No Results Message -->
    <div id="no-results" class="hidden text-center py-12">
      <svg class="w-24 h-24 mx-auto text-gray-300 dark:text-gray-600 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
      </svg>
      <p class="text-gray-500 dark:text-gray-400 text-lg">No projects found in this category.</p>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="section-container bg-gray-50 dark:bg-gray-800">
    <div class="card p-12 text-center">
      <h2 class="text-3xl font-bold mb-4">Have a Project in Mind?</h2>
      <p class="text-gray-600 dark:text-gray-400 mb-8 max-w-2xl mx-auto">
        I'm always open to discussing new projects, creative ideas, or opportunities to be part of your vision.
      </p>
      <a
        href="https://mail.google.com/mail/?view=cm&fs=1&to=rwylieg@gmail.com&su=Hello%20Wylie"
        target="_blank"
        rel="noopener noreferrer"
        class="btn-primary"
      >
        Let's Talk
      </a>
    </div>
  </section>
</BaseLayout>

<style>
  .filter-btn { @apply bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300; }
  .filter-btn.active { @apply bg-blue-600 text-white dark:bg-blue-500; }
</style>

<script type="module" is:inline>
  const filterButtons = document.querySelectorAll('.filter-btn');
  const cards = document.querySelectorAll('[data-category]');
  const noResults = document.getElementById('no-results');

  const applyFilter = (value) => {
    let anyShown = false;
    cards.forEach((card) => {
      const cat = card.getAttribute('data-category');
      const show = value === 'all' || cat === value;
      card.classList.toggle('hidden', !show);
      if (show) anyShown = true;
    });
    noResults?.classList.toggle('hidden', anyShown);
  };

  filterButtons.forEach((btn) => {
    btn.addEventListener('click', () => {
      filterButtons.forEach((b) => b.classList.remove('active'));
      btn.classList.add('active');
      applyFilter(btn.dataset.value || 'all');
    });
  });

  // default state
  filterButtons[0]?.classList.add('active');
  applyFilter('all');
</script>

